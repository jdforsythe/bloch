"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const co_body_1 = require("co-body");
/**
 * Parse request bodies as JSON
 */
exports.getJsonBodyParseMiddleware = () => {
    return async (ctx, next) => {
        ctx.request.body = await co_body_1.json(ctx.req, { limit: '2mb', strict: true });
        if (!ctx.request.body) {
            ctx.status = 400; // Bad Request
            ctx.body = 'Bad Request';
            return;
        }
        return next();
    };
};
/**
 * Get middleware to add the chain to the context
 */
exports.getAddChainToContextMiddleware = (chain) => {
    return async (ctx, next) => {
        ctx.state.chain = chain;
        return next();
    };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWlkZGxld2FyZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9odHRwLWFwaS9taWRkbGV3YXJlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EscUNBQStCO0FBVS9COztHQUVHO0FBQ1UsUUFBQSwwQkFBMEIsR0FBRyxHQUFNLEVBQUU7SUFDaEQsT0FBTyxLQUFLLEVBQUUsR0FBOEIsRUFBRSxJQUFVLEVBQWlCLEVBQUU7UUFDekUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEdBQUcsTUFBTSxjQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7UUFFdkUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFO1lBQ3JCLEdBQUcsQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUMsY0FBYztZQUNoQyxHQUFHLENBQUMsSUFBSSxHQUFHLGFBQWEsQ0FBQztZQUV6QixPQUFPO1NBQ1I7UUFFRCxPQUFPLElBQUksRUFBRSxDQUFDO0lBQ2hCLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQztBQUVGOztHQUVHO0FBQ1UsUUFBQSw4QkFBOEIsR0FBRyxDQUFDLEtBQWlCLEVBQUUsRUFBRTtJQUNsRSxPQUFPLEtBQUssRUFBRSxHQUFZLEVBQUUsSUFBVSxFQUFFLEVBQUU7UUFDeEMsR0FBRyxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1FBRXhCLE9BQU8sSUFBSSxFQUFFLENBQUM7SUFDaEIsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVxdWVzdCwgQ29udGV4dCwgTmV4dCB9IGZyb20gJ2tvYSc7XG5pbXBvcnQgeyBqc29uIH0gZnJvbSAnY28tYm9keSc7XG5pbXBvcnQgeyBCbG9ja2NoYWluIH0gZnJvbSAnLi4vY2hhaW4vaW50ZXJmYWNlJztcblxuLyoqXG4gKiBOZXcgc2hhcGUgb2YgdGhlIGNvbnRleHQgd2l0aCB0aGUgcGFyc2VkIG9iamVjdCBpbiB0aGUgcmVxdWVzdCBib2R5XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSnNvbkJvZHlSZXF1ZXN0Q29udGV4dDxUPiBleHRlbmRzIENvbnRleHQge1xuICByZXF1ZXN0OiBSZXF1ZXN0ICYgeyBib2R5OiBUIHwgdW5kZWZpbmVkIH07XG59XG5cbi8qKlxuICogUGFyc2UgcmVxdWVzdCBib2RpZXMgYXMgSlNPTlxuICovXG5leHBvcnQgY29uc3QgZ2V0SnNvbkJvZHlQYXJzZU1pZGRsZXdhcmUgPSA8VD4oKSA9PiB7XG4gIHJldHVybiBhc3luYyAoY3R4OiBKc29uQm9keVJlcXVlc3RDb250ZXh0PFQ+LCBuZXh0OiBOZXh0KTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgY3R4LnJlcXVlc3QuYm9keSA9IGF3YWl0IGpzb24oY3R4LnJlcSwgeyBsaW1pdDogJzJtYicsIHN0cmljdDogdHJ1ZSB9KTtcblxuICAgIGlmICghY3R4LnJlcXVlc3QuYm9keSkge1xuICAgICAgY3R4LnN0YXR1cyA9IDQwMDsgLy8gQmFkIFJlcXVlc3RcbiAgICAgIGN0eC5ib2R5ID0gJ0JhZCBSZXF1ZXN0JztcblxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHJldHVybiBuZXh0KCk7XG4gIH07XG59O1xuXG4vKipcbiAqIEdldCBtaWRkbGV3YXJlIHRvIGFkZCB0aGUgY2hhaW4gdG8gdGhlIGNvbnRleHRcbiAqL1xuZXhwb3J0IGNvbnN0IGdldEFkZENoYWluVG9Db250ZXh0TWlkZGxld2FyZSA9IChjaGFpbjogQmxvY2tjaGFpbikgPT4ge1xuICByZXR1cm4gYXN5bmMgKGN0eDogQ29udGV4dCwgbmV4dDogTmV4dCkgPT4ge1xuICAgIGN0eC5zdGF0ZS5jaGFpbiA9IGNoYWluO1xuXG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfTtcbn07XG4iXX0=